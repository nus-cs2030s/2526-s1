layout: true
class: basic, layout, imaging, fonts, lists, cards, fadein, tabler
name: content
<div class="basic header"></div>
<div class="basic footer"><p>CS2030S: Programming Methodology II -- Adi Yoga Sidi Prabawa</p></div>

---

name: L05
class: bottom, titles

# CS2030S
## Programming Methodology II
### L05: Generics

.abs.top2.rt4[.img110[![QR](img/dcsaysp.png)]]

---
name: Generics
class: sections

.topsub.subsections[
### Motivation
#### Finding Pairs
]
.botbody.oldsections[
#### Finding Pairs

.col100[
```java
??????? firstLast(int[] array) {
  int first = array[0];
  int last = array[array.length - 1];
  return new ???????(first, last);
}
```
]

.vs10[]

.col100.abs.top35[
.col100[
.rvl-tgl[
.img95.center[![Rice](img/05-rice.jpg)]
]
]
]
]

---

.topsub.subsections[
### Motivation
#### Finding Pairs
#### Integer Pairs
]
.botbody.oldsections[
#### Integer Pairs

.col100[
```java[lite=1,4]
IntPair firstLast(int[] array) {
  int first = array[0];
  int last = array[array.length - 1];
  return new IntPair(first, last);
}
```
]
]

.col100.abs.bot2[
.col100[
```java
class IntPair {
  private int first;
  private int second;

  public IntPair(int first, int second) {
    this.first = first;
    this.second = second;
  }

  public int getFirst() { return this.first; }
  public int getSecond() { return this.second; }
}
```
]
]

---

.topsub.subsections[
### Motivation
#### Finding Pairs
#### Integer Pairs
#### Object Pairs
]
.botbody.oldsections[
#### Object Pairs

.col100[
```java[lite=1,4]
ObjPair firstLast(Object[] array) {
  int first = array[0];
  int last = array[array.length - 1];
  return new ObjPair(first, last);
}
```
]
]

.col100.abs.bot2[
.col100[
```java
class ObjPair {
  private Object first;
  private Object second;

  public ObjPair(Object first, Object second) {
    this.first = first;
    this.second = second;
  }

  public Object getFirst() { return this.first; }
  public Object getSecond() { return this.second; }
}
```
]
]

---

.topsub.subsections[
### Motivation
#### Finding Pairs
#### Integer Pairs
#### Object Pairs
#### Template Pairs
]
.botbody.oldsections[
#### Template Pairs

.col100[
.card.bg-g[
##### Steps

.content.tight[
1. Specify #S: <input type="text" class="text-editor editor18 wt70" id="Stype" value="#S"></input>
2. Specify #T: <input type="text" class="text-editor editor18 wt70" id="Ttype" value="#T"></input>
3. Generate Code
<div class="font18"><kbd><code class="hljs remark-skip java remark-code-none"><div class="remark-code-line"><span class="typeS">#S</span><span class="typeT">#T</span>Pair course = <span class="hljs-keyword">new</span> <span class="typeS">#S</span><span class="typeT">#T</span>Pair(<span class="hljs-string">"CS"</span>, <span class="hljs-number">2030</span>)</div><div class="remark-code-line"><span class="typeT">#T</span> code = (<span class="typeT">#T</span>) course.getSecond();</div></code></kbd>
</div>
4. Recompile and Execute
]
]
]
]

.col100.abs.bot2.l05manual[
<div class="col100" style="top:-1.6%;position:relative;">
<div class="font18"><kbd><code class="hljs remark-skip java remark-code-none"><div class="remark-code-line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title"><span class="typeS">#S</span><span class="typeT">#T</span>Pair</span> </span>{</div><div class="remark-code-line">  <span class="hljs-keyword">private</span> <span class="typeS">#S</span> first;</div><div class="remark-code-line">  <span class="hljs-keyword">private</span> <span class="typeT">#T</span> second;</div><div class="remark-code-line"></div><div class="remark-code-line">  <span class="hljs-keyword">public</span> <span class="typeS">#S</span><span class="typeT">#T</span>Pair(<span class="typeS">#S</span> first, <span class="typeT">#T</span> second) {</div><div class="remark-code-line">    <span class="hljs-keyword">this</span>.first = first;</div><div class="remark-code-line">    <span class="hljs-keyword">this</span>.second = second;</div><div class="remark-code-line">  }</div><div class="remark-code-line"></div><div class="remark-code-line">  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="typeS">#S</span> <span class="hljs-title">getFirst</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.first; }</div><div class="remark-code-line">  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="typeT">#T</span> <span class="hljs-title">getSecond</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.second; }</div><div class="remark-code-line">}</div></code></kbd>
</div>
</div>
]

---

.topsub.subsections[
### Motivation
### Generic
#### Generic Class
]
.botbody.oldsections[
### Generic
#### Generic Class


.col100.rvl-step[
```java[lite=1,3]
Pair<Integer, Integer> firstLast(int[] array) {
  // : code omitted
  return new Pair<Integer, Integer>(first, last);
}
```
.rvl-num[1]
]

.col100.rvl-step[
```java[lite=5]
Pair<String, Pair<Integer, String>> course =
    new Pair<String, Pair<Integer, String>>("CS",
        new Pair<Integer, String>(2030, "S"));
​
Integer code1 = course.getSecond();  // compilation error!
Integer code2 = course.getSecond().getFirst();  // ok
```
.rvl-num[2]
]

.col100.abs.bot2[
.col100[
```java
class Pair<S, T> {
  private S first;
  private T second;
  public Pair(S first, T second) { .. }
  public S getFirst() { return this.first; }
  public T getSecond() { return this.second; }
}
```
]
]
]

---

.topsub.subsections[
### Motivation
### Generic
#### Generic Class
#### Extending Generic
]
.botbody.oldsections[
### Generic
#### Extending Generic

.col100[
```java
class Pair<S, T> {
  // : other code omitted
  public Pair(S first, T second) { .. }
}
```
```java
class DictionaryEntry<T> extends Pair<String, T> {
  // : other code omitted
  public DictionaryEntry(String key, T elem) {
    super()
  }
}
```
]

.col100[
.rvl-step[
##### Correct Usage

```java
DictionaryEntry<String> code;
code = new DictionaryEntry<String>("Course", "CS2030S");
code.getFirst();  // "Course"
DictionaryEntry<Object> dictionary =
   new DictionaryEntry<Object>("Dictionary", code);
dictionary.getSecond();  // the above dictionary
```
.rvl-num[1]
]

.rvl-step[
##### Incorrect Usage

```java
DictionaryEntry<String> d1 = new DictionaryEntry<Object>(..);
DictionaryEntry<Object> d2 = new DictionaryEntry<String>(..);
```
.rvl-num[2]
]
]
]
.abs.top2.rt0.wt50.rvl-step[
.card.warns[
##### Warning
.content.tight[
Java generic is .X[invariant] .note18[(more on this next week)]
]
].rvl-num[2]
]

---

.topsub.subsections[
### Motivation
### Generic
#### Generic Class
#### Extending Generic
#### Generic Method
]
.botbody.oldsections[
### Generic
#### Generic Method

.col100[
```java
public static <T> boolean contains(T[] array, T obj) {
  for (T curr : array) {
    if (curr.equals(obj)) {
      return true;
    }
  }
  return false;
}
```
]

.vs10[]

.col100.rvl-step[
##### Generic Method Invocation
```java[lite=2]
String[] strArray = new String[] { "hello", "world" };
Contains.<String>contains(strArray, 123);
```
.rvl-num[1]
]
.col100.rvl-step[
```java[lite=1]
Contains.<String>contains(strArray, "CS2030S");
```
.rvl-num[2]
]

.col100.rvl-step[
```java[lite=2]
Circle[] circArray = new Circle[] { new Circle(...) };
Contains.contains(circArray, new Square(...));  // ???
```
.rvl-num[3]
]
]

---

.topsub.subsections[
### Motivation
### Generic
### Bound
#### Motivation
]
.botbody.oldsections[
### Bound
#### Motivation

.col100[
```java
public static <T>
    T findLargest(T[] array) {
  double maxArea = 0;
  T largest = null;
  for (T curr : array) {
    double currArea = curr.getArea();
    if (currArea > maxArea) {
      maxArea = currArea;
      largest = curr;
    }
  }
  return largest;
}
```
]
]

---

.topsub.subsections[
### Motivation
### Generic
### Bound
#### Motivation
#### Bounded Generic
]
.botbody.oldsections[
### Bound
#### Bounded Generic

.col100[
```java[lite=1,6,12]
public static <T extends GetAreable>
    T findLargest(T[] array) {
  double maxArea = 0;
  T largest = null;
  for (T curr : array) {
    double currArea = curr.getArea();  // T <: GetAreable
    if (currArea > maxArea) {
      maxArea = currArea;
      largest = curr;
    }
  }
  return largest;
}
```
]

.vs10[]

.col100.unrvl-tgl[
```java
findLargest(circleArr);
findLargest(shapeArr);
findLargest(stringArr);
```
]
.col100.rvl-tgl[
```java[lite=3]
findLargest(circleArr);
findLargest(shapeArr);
findLargest(stringArr);  // compile error
```
]
]

---

.topsub.subsections[
### Motivation
### Generic
### Bound
### Comparable
#### Documentation
]
.botbody.oldsections[
#### Documentation

.col100[
<iframe class="inline-frame" src="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Comparable.html#method-summary" frameborder="0" width="100%" height="600px"></iframe>
]
]

---

.topsub.subsections[
### Motivation
### Generic
### Bound
### Comparable
#### Documentation
#### Comparable Pair
]
.botbody.oldsections[
#### Comparable Pair

.col100.unrvl[
```java
class Pair<S, T>
    implements Comparable<Pair> {
  private S first;
  private T second;
​
  // : code omitted
  @Override
  public int compareTo(Pair<S, T> s1) {
    return this.first.compareTo(s1.first);
  }
}
```
]
.col100.rvl-step[
```java[lite=1-2]
class Pair<S extends Comparable<S>, T>
    implements Comparable<Pair<S, T>> {
  private S first;
  private T second;
​
  // : code omitted
  @Override
  public int compareTo(Pair<S, T> s1) {
    return this.first.compareTo(s1.first);
  }
}
```
.rvl-num[1]
]
.col100.rvl-step[
```java
Object[] array = new Object[] {
  new Pair<String, Integer>("Alice", 1),
  new Pair<String, Integer>("Carol", 2),
  new Pair<String, Integer>("Bob", 3),
  new Pair<String, Integer>("Dave", 3),
};
java.util.Arrays.sort(array);
```
.rvl-num[2]
]
]
.footnote.note18[https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Arrays.html]

---

name: Break
class: middle, break

# Break

<br>

## <i class="fa-regular fa-clock break-icon"></i>

---
name: Type_Erasure
class: sections

.topsub.subsections[
### Implementation
#### Specialization
]
.botbody.oldsections[
#### Specialization

.col100[
.card.bg-r[
##### Code Specialization
.content.tight[
Generate a new class for every new type argument .note18[(e.g., C#, C++, Rust)].
]
]
]

.vs10[]

.col100[
##### Usage

```java
Pair<String, Integer> p1;
Pair<Double, Double>  p2;
Pair<Integer, Double> p3;
```
]
.col100[
##### Generated Code

```java
Pair_String_Integer p1;
Pair_Double_Double  p2;
Pair_Integer_Double p3;
```
]
.col100[
##### Generated Class

```java
class Pair_String_Integer { ... }
class Pair_Double_Double  { ... }
class Pair_Integer_Double { ... }
```
]
]

---

.topsub.subsections[
### Implementation
#### Specialization
#### Code Sharing
]
.botbody.oldsections[
#### Code Sharing

.col100[
.card.bg-g[
##### Code Sharing
.content.tight[
Erase type arguments and type parameters after type checking .note18[(e.g., Java)].
]
]
]

.vs10[]

.col100[
##### Usage

```java
Pair<String, Integer> p;
p = new Pair<String, Integer>(...);
Integer i = p.getSecond();
```
]
.col100[
##### Generated Code

```java
Pair p;
p = new Pair(...);
Integer i = (Integer) p.getSecond();
```
]
.col100[
##### Generated Class

```java
// no new class is created
```
]
]

---

.topsub.subsections[
### Implementation
### Type Erasure
#### Basic
]
.botbody.oldsections[
#### Basic

.col100[
##### Generic Pair

```java
class Pair<S, T> {
  private S          first;
  private T          second;
  public Pair(S          first, T          second) {
    this.first = first;
    this.second = second;
  }
  public S          getFirst() {
    return this.first;
  }
  public T          getSecond() {
    return this.second;
  }
}
```

```java
Pair<String, Integer> p
    = new Pair<String, Integer>("hello", 4);
Integer i =           p.getSecond();
```
]
]

---

.topsub.subsections[
### Implementation
### Type Erasure
#### Basic
]
.botbody.oldsections[
#### Basic

.col100[
##### Generated Code

```java
class Pair       {
  private Object     first;
  private Object     second;
  public Pair(Object     first, Object     second) {
    this.first = first;
    this.second = second;
  }
  public Object     getFirst() {
    return this.first;
  }
  public Object     getSecond() {
    return this.second;
  }
}
```

```java
Pair                  p
    = new Pair                 ("hello", 4);
Integer i = (Integer) p.getSecond();
```
]
]

---

.topsub.subsections[
### Implementation
### Type Erasure
#### Basic
#### Bounded Generic
]
.botbody.oldsections[
#### Bounded Generic

.col100[
##### Generic Pair

```java
class Pair<S, T extends GetAreable> {
  private S          first;
  private T          second;
  public Pair(S          first, T          second) {
    this.first = first;
    this.second = second;
  }
  public S          getFirst() {
    return this.first;
  }
  public T          getSecond() {
    return this.second;
  }
}
```

```java
Pair<String, Integer> p
    = new Pair<String, Integer>("hello", 4);
Integer i =           p.getSecond();
```
]
]

---

.topsub.subsections[
### Implementation
### Type Erasure
#### Basic
#### Bounded Generic
]
.botbody.oldsections[
#### Bounded Generic

.col100[
##### Generated Code

```java
class Pair                          {
  private Object     first;
  private GetAreable second;
  public Pair(Object     first, GetAreable second) {
    this.first = first;
    this.second = second;
  }
  public Object     getFirst() {
    return this.first;
  }
  public GetAreable getSecond() {
    return this.second;
  }
}
```

```java
Pair                  p
    = new Pair                 ("hello", 4);
Integer i = (Integer) p.getSecond();
```
]
]

---

.topsub.subsections[
### Implementation
### Type Erasure
### Limitation
]
.botbody.oldsections[
#### Generic Array

.col100[
.card.bg-r[
##### No Generic Array
.content.tight[
```java[copy=nones]
new Pair<String, Integer>[2];
new Pair<S, T>[2];
new T[2];
```
]
]
]

.vs10[]

.col100[
.card.bg-g[
##### Can Still Declare
.content.tight[
```java[copy=nones]
Pair<String, Integer>[] arr1;
Pair<S, T>[] arr2;
T[] arr3;
```
]
]
]

.vs10[]

.col100.rel.inblock[
<pre class="text-editor editor16" id="pair_editor" style="height:250px">
Pair&lt;String, Integer&gt;[] pairArray;
Object[] objArray;

pairArray = new Pair&lt;String, Integer&gt;[2];
objArray = pairArray;

objArray[0] = new Pair&lt;Double, Boolean&gt;(3.14, true);
String str = pairArray[0].getFirst();
</pre>
]
]

---

.topsub.subsections[
### Implementation
### Type Erasure
### Limitation
### Quizzes
#### Quiz #1
]
.botbody.oldsections[
### Quizzes
#### Quiz #1

.col100[
.card.bg-r[
##### Question
.content.tight[
Consider the class `B` below.
What is the compile-time type of `I` after type erasure?
]
]
]

.vs10[]

.col100[
```java
class A {}
class B<D extends A, I extends D> {
  private D d;
  private I i;
}
```
]

.mrq[
1. .quiz-choice[`Object`] .quiz-ans[1] .quiz-hint[NO: not the upper-bound`]
2. .quiz-choice[`A`] .quiz-ans[0] .quiz-hint[YES: because the upper-bound of `D` is `A`]
3. .quiz-choice[`D`] .quiz-ans[0] .quiz-hint[NO: cannot have generic anymore]
3. .quiz-choice[`I`] .quiz-ans[0] .quiz-hint[NO: cannot have generic anymore]

.quizzes-time[120]
.quizzes-link[HiNpv8RXvEpY0ZeqqQtnZ]
]
]

---
name: Generic_Sequence
class: sections

.topsub.subsections[
### Seq&lt;T&gt;
]
.botbody.oldsections[
### Seq&lt;T&gt;
]

---

.topsub.subsections[
### Seq&lt;T&gt;
### Suppress
]
.botbody.oldsections[
#### Suppressing Unchecked Warning

.col100.unrvl-tgl[
##### @SuppressWarnings

```java
class Seq<T> {
  private T[] array;

  public Seq(int size) {
    // The only way we can put an object into 
    // array is through the method set() and we 
    // only put object of type T inside.
    // So it is safe to cast `Object[]` to `T[]`.
    @SuppressWarnings("unchecked")
    T[] temp = (T[]) new Object[size];
    this.array = temp;
  }
​
  // : other code omitted
​
  public void getArray() {
    return this.array;
  }
}
```
]
.col100.rvl-tgl[
##### @SuppressWarnings

```java
class Seq<T> {
  private T[] array;

  public Seq(int size) {
    // The only way we can put an object into 
    // array is through the method set() and we 
    // only put object of type T inside.
    // So it is safe to cast `Object[]` to `T[]`.
    @SuppressWarnings("unchecked")
    T[] temp = (T[]) new Object[size];
    this.array = temp;
  }
​
  // getArray() is unsafe due to the following!
  // Seq<String> strSeq = new Seq<String>(2);
  // Object[] objArray = strSeq.getArray();
  // objArray[0] = 5;
  // String s = strSeq.get(0);
}
```
]
]

---

.topsub.subsections[
### Seq&lt;T&gt;
### Suppress
### Warning
]
.botbody.oldsections[
#### Do NOT Use Raw Types

.col100[
```java[lite=1,2]
Seq strArray = new Seq(2);
void setSeq(Seq s) {
  s.set(0, 1234);
}
```

.card.bg-b[
##### Still OK.cite[]
.content.tight[
```java
obj instanceof Pair
```
]
]
]
]
.footnote.note18[Only for this exercise, next week we will learn a better way.]

---
name: Reminders
class: sections

.topsub.subsections[
### Todo
]
.botbody.oldsections[
.col100[
.card.notes[
##### Weekly
.content.tight.todo[
- Start reading notes on [.U[Week 06]](https://nus-cs2030s.github.io/2526-s1/notes/week06/index.html) .note18[(for next week lecture)]
- Complete [.U[Diagnostic Quiz 5]](https://canvas.nus.edu.sg/courses/77787/quizzes/64360) .note18[(last reminder)]
]
]

.card.notes[
##### Midterm
.content.tight.todo[
- .X[29 Sep 2025 ~~12:15 - 13:15~~ 12:30 - 13:30 @ MPSH] .note18[(Unit 1 - 27)]
    - [.U[Administration]](https://canvas.nus.edu.sg/courses/77787/pages/midterm-administration) ; PYP will be on Canvas
]
]

.card.notes[
##### Lab
.content.tight.todo[
.X[No lab exercise this week.]
]
]

.card.notes[
##### Programming Exercises
.content.tight.todo[
- Exercise 2 deadline today
    - .X[Submit your exercise on time] to get feedback .note18[(on design)] from your TA
    - If your code is incorrect, you will get 0 mark for PE .note18[(you can run test cases)]
- Exercise 3 will be released this week
    - Further build upon Exercise 2
    - You should address concern raised by your TA first .note18[(otherwise, the feedback will be the same)]
]
]
]
]

---

class: middle, end, fadein

.eol[`jshell> /exit`]


.eol[`| Goodbye`]